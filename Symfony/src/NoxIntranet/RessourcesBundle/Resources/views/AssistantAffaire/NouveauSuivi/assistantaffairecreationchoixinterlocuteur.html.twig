{% extends "::layout.html.twig" %}

{% block titrePage %} Choix de l'interlocuteur {% endblock %}

{% block messageAccueil %}Choix de l'interlocuteur{% endblock %}

{% block contenu %}

    <div class="DivCreationSuiviRetour">
        <a href="{{ path('nox_intranet_assistant_affaire_nouvelle_choix_client', {'IdSuivi': IdSuivi}) }}"><img src='{{ asset('bundles/noxintranetressources/images/Left-Arrow-48.png') }}' alt='Flêche retour'>Retourner au choix du client</a>
    </div>

    <div id="DivFormulaireChoixInterlocuteur">

        {{ form_start(form, {'attr': {'class': 'formulaireChoixInterlocuteur'}}) }}
        {{ form_errors(form) }}

        <fieldset>

            <legend>Interlocuteur</legend>

            <p style='margin: 0;'><!--
                --><label for="rechercheSuivi">Recherche</label><br /><!--
                --><input placeholder="Ex : Ventes 2016" name='rechercheSuivi' type="text" id="rechercheSuivi" style='width: 70%; margin-bottom: 2%; box-sizing: border-box;'/><br /><!--
                -->{{ form_errors(form.NoInterlocuteur) }}<!--
                -->{{ form_widget(form.NoInterlocuteur, {'attr': {'class': 'selectFormulaireChoixInterlocuteur champChoixInterlocuteur', 'size':'15', 'style': 'width: 70%; margin-bottom: 2%;'}}) }}<!--

                --><br /><!--

                -->{{ form_widget(form.Choisir, {'label': 'Choisir cet interlocuteur', 'attr': {'class': 'boutonFormulaire' }}) }}<!--
                --></p>
        </fieldset> 

        {{ form_end(form) }}

    </div>

    <script>
        $(window).load(function () {
            searchSuivi('#rechercheSuivi', '.selectFormulaireChoixInterlocuteur');
        });

        // Affiche les suivis selon le nom recherché.
        function searchSuivi(champRecherche, selecteur) {

            // Initialisation d'un timer pour executer la fonction après 1 seconde sans frappe.
            var typewatch = (function () {
                var timer = 0;
                return function (callback, ms) {
                    clearTimeout(timer);
                    timer = setTimeout(callback, ms);
                };
            })();

            // Lorsque une valeur est entré dans la barre de recherche.
            $(champRecherche).keyup(function () {
                typewatch(function () {
                    // Pour chaque résultat.
                    $(selecteur + ' option').each(function () {
                        // Si il ne correspond pas à la recherche...
                        if ($(this).text().search(new RegExp($(champRecherche).val(), 'i')) === -1) {
                            $(this).hide(); // ...On le cache.
                        }
                        // Si il correspond à la recherche.
                        else {
                            // On le montre et on lui donne son nom comme attribut 'title'.
                            $(this).show();
                            $(this).attr('title', $(this).text());
                        }
                    });
                    // On applique une couleur différente au résultat pair et impair.
                    $(selecteur + ' option:visible:odd').css('background', 'SeaShell');
                    $(selecteur + ' option:visible:even').css('background', 'white');
                }, 500);
            });
        }
    </script>

{% endblock %}

{# empty Twig template #}
